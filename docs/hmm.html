<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dynamic URL Update</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    Background color:
    <input type="text" id="bgInput" placeholder="Enter background color">
    <br>
    Tier Names:
    <br>
    <textarea id="catsInput" placeholder="Enter text\n(max 200 characters total)" rows="16"></textarea>
    <br>
    Items:
    <br>
    <textarea id="itemsInput" placeholder="Enter text\n(max 200 characters total)" rows="16"></textarea>
    <br>
    <button id="updateUrlBtn">Submit</button>

    <script>
        $(document).ready(function () {
            // Enforce character limit in the textareas: item list, category list
            $('#itemsInput').on('input', function () {
                const maxLength = 50;
                const currentText = $(this).val();
                if (currentText.length > maxLength) {
                    $(this).val(currentText.substring(0, maxLength));
                }
            });
            $('#catsInput').on('input', function () {
                const maxLength = 50;
                const currentText = $(this).val();
                if (currentText.length > maxLength) {
                    $(this).val(currentText.substring(0, maxLength));
                }
            });

            $('#updateUrlBtn').click(function () {
                const newBg = $('#bgInput').val();
                const newItems = $('#itemsInput').val();
                const newCats = $('#catsInput').val();
                let newUrl = `${window.location.origin}${window.location.pathname}`;
                const params = new URLSearchParams();

                if (newBg) {
                    params.set('bg', newBg);
                    $('body').css('background-color', newBg); // Set background color
                }
                if (newItems) {
                    params.set('items', newItems);
                }

                if (newItems) {
                    params.set('cats', newCats);
                }

                if (params.toString()) {
                    newUrl += `?${params.toString()}`;
                }

                window.history.pushState(null, '', newUrl);
                console.log('URL updated:', newUrl); // Debugging output
            });

            // Set background color on page load if 'bg' exists in URL
            const params = new URLSearchParams(window.location.search);
            const bgColor = params.get('bg');
            if (bgColor) {
                $('body').css('background-color', bgColor);
            }
        });
    </script>
</body>
</html>
